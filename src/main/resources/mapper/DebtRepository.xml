<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cheongsan.domain.debt.repository.DebtRepository">

    <!-- 총 대출 항목 조회-->
    <select id="getUserDebtList" parameterType="long" resultType="cheongsan.domain.debt.dto.DebtInfoDTO">
        SELECT da.id                AS debtId,
               da.debt_name         AS debtName,
               fi.organization_name AS organizationName,
               da.current_balance   AS currentBalance,
               da.original_amount   AS originalAmount,
               da.interest_rate     AS interestRate,
               da.loan_start_date   AS loanStartDate
        FROM mountain_db.debt_accounts da
                 JOIN mountain_db.financial_institutions fi ON da.organization_code = fi.organization_code
        WHERE da.user_id = #{userId}
    </select>

    <!-- 대출별 상세 조회-->
    <select id="getLoanDetail" parameterType="long" resultType="cheongsan.domain.debt.dto.DebtDetailDTO">
        SELECT da.debt_name           AS debtName,
               fi.organization_name   AS organizationName,
               da.original_amount     AS originalAmount,
               da.interest_rate       AS interestRate,
               da.loan_start_date     AS loanStartDate,
               da.current_balance     AS currentBalance,
               da.grace_period_months AS gracePeriodMonths,
               da.repayment_method    AS repaymentMethod
        FROM mountain_db.debt_accounts da
                 JOIN mountain_db.financial_institutions fi ON da.organization_code = fi.organization_code
        WHERE da.id = #{loanId}
    </select>


</mapper>
